<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.0/animate.min.css"/>
    <style type="text/css">
      .container {
        position:absolute;
        left:0;
        top:0;
        width:100vw;
        height:100vh;
        display: flex;
        background-color:grey;
      }
      canvas {
        background-color: grey;
        width: 100%;
        height:100%;
      }
      svg {
        transform-box: fill-box;
        position: absolute;
        top: 0;
      }
      #broken {
        z-index:1;
      }
      .f_bulb {
        visibility: hidden;
        z-index: 1;
      }
      #end_bulb {
        z-index:0;
        opacity:0;
        transition: all 1s;
      }
    </style>
  </head>
  <body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/3.0.16/svg.min.js" integrity="sha512-p3Tp2zn+wApBreZCgRkmMwnfpN8MUPXzzOihXx7iGYXqE7t6m9drY8HeyMeeFuDWiTFKrGUrq3jpbT0vX6zY/Q==" crossorigin="anonymous"></script>

    <div class="container">
      <!--<canvas id="canvas"></canvas>-->
      <svg id="broken" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080"><defs><style>.cls-1{fill:#d6d6d6;}.cls-2{fill:#3f3f3f;}.cls-3{fill:#9d9d9d;}.cls-4{fill:#d8d8d8;}.cls-5,.cls-6{fill:none;}.cls-5{stroke:#3f3f3f;stroke-linejoin:round;stroke-width:9px;}.cls-6{stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:19px;}</style></defs><title>Light Bulb</title><g id="레이어_1" data-name="레이어 1">
        <path class="cls-1 br_bulb" d="M1018.58,598.79c46.12,28.75,64.34,84.5,44.78,134.85-20.68,53.26-80.17,82.38-134.7,65.89-3.2-1-6.27-2.41-10.37-4,4.44-10,8.39-18.68,12.16-27.42,6.49-15,5.93-16.92-6.92-26.42-2.16-1.59-4.19-3.36-7.38-5.94,7.67-6.5,14.77-12.57,21.92-18.58,6.1-5.12,10-11.2,4-18.37s-12.53-4.25-18.62.9c-10.41,8.81-21.06,17.34-31.41,26.22-8.45,7.24-8.18,14,.42,21.11,17,14.06,17,14.07,7,33.83a33.81,33.81,0,0,1-2.26,3.25c-23.35-16-38.47-37.45-44.86-64.6-11.43-48.55,7.36-94.38,49.69-121,8.46-5.31,11.22-11.43,11.09-20.92-.35-25,7-31.94,32.3-32,11.6,0,23.2-.08,34.79,0,17.17.13,25.75,8.21,27,25.27a38.93,38.93,0,0,1,.05,7.16C1006.22,587.71,1010.21,593.58,1018.58,598.79Z"/>
        <path class="cls-2 br_bulb" d="M1037.67,583.92c44.81,32,65.47,87.16,52.63,139.58-13.44,54.84-56.76,94.28-112.32,102.24-59.08,8.47-119.77-26.51-141.76-81.69-23.18-58.19-4.3-124.27,45.23-159.77,3.87-2.77,8-8,8.37-12.34,2.56-32.07,19.62-49,51.76-49.82,6.14-.17,12.28,0,18.42,0v.64c8.51,0,17.11-.79,25.52.14,27.5,3,43.71,20.35,44.78,47.9C1030.54,577,1032.79,580.43,1037.67,583.92Zm25.69,149.72c19.56-50.35,1.34-106.1-44.78-134.85-8.37-5.21-12.36-11.08-11.26-20.68a38.93,38.93,0,0,0-.05-7.16c-1.22-17.06-9.8-25.14-27-25.27-11.59-.1-23.19,0-34.79,0-25.28,0-32.65,7-32.3,32,.13,9.49-2.63,15.61-11.09,20.92C859.79,625.12,841,671,852.43,719.5c6.39,27.15,21.51,48.61,44.86,64.6a33.81,33.81,0,0,0,2.26-3.25c9.94-19.76,9.93-19.77-7-33.83-8.6-7.13-8.87-13.87-.42-21.11,10.35-8.88,21-17.41,31.41-26.22,6.09-5.15,12.6-8.13,18.62-.9s2.06,13.25-4,18.37c-7.15,6-14.25,12.08-21.92,18.58,3.19,2.58,5.22,4.35,7.38,5.94,12.85,9.5,13.41,11.42,6.92,26.42-3.77,8.74-7.72,17.42-12.16,27.42,4.1,1.6,7.17,3,10.37,4C983.19,816,1042.68,786.9,1063.36,733.64Z"/>
        <path class="cls-2 br_bulb" d="M959.47,513.57c-10.23,0-20.46-.09-30.69,0-7.91.1-12.66-3.87-12.6-11.5.05-7.26,5.34-11,12.27-11.07,21.14-.23,42.29-.31,63.42.1,7.19.14,12.57,3.9,12,12.19-.54,7.66-5.64,10.29-12.68,10.27Z"/>
        <path class="cls-2 br_bulb" d="M960.64,459.47c6.11,0,12.22-.06,18.33,0,7.61.1,12.6,3.78,12.57,11.57,0,7.37-5,10.88-12.07,11q-19.34.3-38.69,0c-7-.12-12-3.41-12-11,0-8,4.94-11.46,12.51-11.58C947.74,459.39,954.2,459.47,960.64,459.47Z"/>
        <polygon class="cls-3" points="967.25 315.5 940.25 315.5 920.25 391.5 970.25 391.5 967.25 315.5"/>
        <rect class="cls-3" x="920.75" y="392" width="50" height="101"/>
        <polygon class="cls-4" points="965.75 316 968.75 392 999.75 392 979.75 314 965.75 316"/>
        <polygon class="cls-4" points="996.75 493 968.75 493 968.75 392 999.75 392 996.75 493"/>
        <line class="cls-5" x1="959.75" y1="315.04" x2="960.25" y2="-0.46"/>
        <rect class="cls-5" x="919.5" y="391.5" width="81" height="101"/>
        <polyline class="cls-5" points="919.5 391.5 940 313.5 981 313.5 1000.5 391.5"/>
        <path class="cls-6 br_bulb" d="M1044.5,706.5S1035,758,982,779"/>

      </g></svg>

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080"><defs><style>.cls-7{fill:#3f3f3f;}.cls-8{stroke:#d6d6d6;stroke-linecap:round;stroke-miterlimit:10;stroke-width:19px;}</style></defs><title>Light Bulb</title><g id="레이어_1" data-name="레이어 1">
        <path class="cls-7 f_bulb" d="M962,577.5c8.41,0,16.9-.78,25.2.14,27.16,3,43.17,20.1,44.23,47.31.24,6.19,2.46,9.54,7.28,13,44.25,31.61,64.65,86.07,52,137.84-13.27,54.17-56,93.11-110.92,101-58.35,8.36-118.29-26.18-140-80.68-22.9-57.47-4.25-122.73,44.67-157.79,3.81-2.73,7.92-7.87,8.26-12.19,2.53-31.66,19.38-48.34,51.12-49.2,6.06-.16,12.13,0,18.19,0ZM920.81,846.91c4.05,1.58,7.07,3,10.24,4,53.85,16.29,112.6-12.47,133-65.07,19.32-49.73,1.32-104.78-44.22-133.17-8.27-5.15-12.22-11-11.13-20.43a38,38,0,0,0-.05-7.07c-1.2-16.85-9.68-24.83-26.63-25-11.45-.09-22.9,0-34.36,0-25,0-32.24,6.86-31.9,31.56.13,9.37-2.6,15.41-10.95,20.65-41.81,26.26-60.36,71.52-49.08,119.47,6.32,26.81,21.24,48,44.31,63.8"/>
        <path class="cls-7 f_bulb" d="M961.48,568.46c-10.11,0-20.21-.09-30.31,0-7.82.09-12.5-3.82-12.45-11.36.06-7.17,5.28-10.86,12.12-10.93,20.88-.22,41.77-.31,62.64.1,7.09.14,12.41,3.85,11.83,12-.53,7.56-5.57,10.16-12.51,10.14Z"/>
        <path class="cls-7 f_bulb" d="M962.64,515c6,0,12.06-.06,18.1,0,7.51.1,12.44,3.73,12.41,11.43,0,7.27-5,10.75-11.92,10.85q-19.1.3-38.21,0c-6.88-.12-11.83-3.37-11.84-10.84,0-7.87,4.88-11.32,12.35-11.44C949.9,515,956.27,515,962.64,515Z"/>
        <path class="cls-8 f_bulb" d="M954.86,830.5s-51.5-9.5-72.5-62.5"/></g></svg>

      <svg id="end_bulb" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080"><defs><style>.cls-11,.cls-12{fill:#ffff31;}.cls-11{opacity:0.09;}.cls-12{opacity:0.25;}.cls-13{fill:#707070;opacity:0.22;}.cls-14{fill:#ffef24;}.cls-15{fill:#3f3f3f;}.cls-20,.cls-19{fill:none;}.cls-19{stroke:#fff;}.cls-20,.cls-19{stroke-linecap:round;stroke-miterlimit:10;stroke-width:19px;}.cls-20{stroke:#ffef24;opacity:0.45;}</style></defs><title>Light Bulb</title><g id="레이어_1" data-name="레이어 1">
        <circle class="cls-11" cx="956.55" cy="657.46" r="428.25"/>
        <circle class="cls-12" cx="960.5" cy="652.5" r="326.5"/>
        <path class="cls-13" d="M960,526c8.41,0,16.9-.78,25.2.14,27.16,3,43.17,20.09,44.23,47.3.24,6.2,2.46,9.55,7.28,13,44.25,31.61,64.65,86.07,52,137.85-13.27,54.16-56,93.11-110.92,101-58.35,8.36-118.29-26.18-140-80.68-22.9-57.46-4.25-122.73,44.67-157.78,3.81-2.74,7.92-7.88,8.26-12.19,2.53-31.67,19.38-48.35,51.12-49.2,6.06-.17,12.13,0,18.19,0Z"/>
        <path class="cls-14" d="M1017.86,601.11c45.54,28.39,63.54,83.44,44.22,133.17-20.43,52.6-79.18,81.36-133,65.08-3.17-1-6.19-2.38-10.24-4l-20.74-11.27c-23.07-15.79-38-37-44.31-63.81-11.28-47.94,7.27-93.2,49.08-119.46,8.35-5.25,11.08-11.28,10.95-20.66-.34-24.69,6.93-31.55,31.9-31.56,11.46,0,22.91-.07,34.36,0,17,.14,25.43,8.11,26.63,25a38,38,0,0,1,.05,7.07C1005.64,590.16,1009.59,596,1017.86,601.11Z"/>
        <path class="cls-15" d="M959.48,517c-10.11,0-20.21-.1-30.31,0-7.82.09-12.5-3.83-12.45-11.36.06-7.18,5.28-10.86,12.12-10.94,20.88-.22,41.77-.31,62.64.1,7.09.14,12.41,3.85,11.83,12-.53,7.56-5.57,10.16-12.51,10.15Q975.14,516.93,959.48,517Z"/>
        <path class="cls-15" d="M960.64,463.52c6,0,12.06-.07,18.1,0,7.51.11,12.44,3.74,12.41,11.44,0,7.27-5,10.74-11.92,10.85q-19.1.29-38.21,0c-6.88-.12-11.83-3.38-11.84-10.85,0-7.86,4.88-11.31,12.35-11.43C947.9,463.43,954.27,463.52,960.64,463.52Z"/>
        <path class="cls-19" d="M958.85,773.39s-51.25-10.74-71-64.22"/>
        <line class="cls-20" x1="1088" y1="546" x2="1185.5" y2="488.5"/>
        <line class="cls-20" x1="1122.5" y1="652.5" x2="1230.5" y2="627.5"/>
        <line class="cls-20" x1="1122.5" y1="752.5" x2="1191.5" y2="794.5"/>
        <line class="cls-20" x1="1044.5" y1="842.5" x2="1095.5" y2="912.5"/>
        <line class="cls-20" x1="952.5" y1="860.5" x2="952.5" y2="955.5"/>
        <line class="cls-20" x1="850.5" y1="836.5" x2="805.5" y2="890.5"/>
        <line class="cls-20" x1="795.5" y1="733.5" x2="712.5" y2="773.5"/>
        <line class="cls-20" x1="798.5" y1="656.5" x2="697.5" y2="609.5"/>
        <line class="cls-20" x1="850.5" y1="548.5" x2="764.5" y2="485.5"/></g></svg>
    </div>

    <script type="text/javascript">

      function wobble(side,t) {
        var d = []
        if (side == 'L') {
          d = [-10,-5,1.5]
        }
        else if (side == 'R') {
          d = [15,35,-1.5]
        }
        anime({
          targets: t, // broken bulb
          translateX: [0,d[0]],
          translateY:[0,d[1]],
          rotate:[0,d[2]],
          duration: 500,
          direction: 'alternate',
          easing: 'easeInOutSine',
        });
      }

      var replace = false; // check if bulb replacement has been done
      function fall() {
        var tl = anime.timeline({
          easing: 'easeOutExpo',
          duration: 750
        });
        tl
        .add({
          targets: '.br_bulb',
          translateY:window.innerHeight + 100,
          complete: function(anim) {
              console.log('complete');
              $('.br_bulb').css('visibility','hidden');
              $('.f_bulb').css('visibility','visible');
              replace = true; // broken bulb has been replaced
          }
        })
        tl
        .add({
          targets: '.f_bulb',
          translateY:[window.innerHeight + 100,0],
        })
      }

      function complete() {
        anime({
          targets: '.f_bulb',
          easing: 'easeOutExpo',
          opacity:[0,1],
          duration: 750,
          translateY:[0,-51],
          complete: function(anim) {
              $('#end_bulb').css('opacity','1');
              $('.f_bulb').css('visibility','hidden');
          }
        })
      }

      $(function() {
        var count = 0;
        var left = false; // check if bulb has moved left
        $('.container').click(function() {
          if (left==false) {
            if (replace) {
              wobble('L','.f_bulb');
            }
            else {
              wobble('L','.br_bulb');
            }
            left = true;
            count++;
          }
          else {
            if (replace) {
              wobble('R','.f_bulb');
            }
            else {
              wobble('R','.br_bulb');
            }
            left = false;
            count++;
          }

          if (count == 5) {
            fall();
          }
          else if (count == 10) {
            complete();
          }
        })
      })
    </script>

  </body>
</html>
